<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Better YouTube</title>
    <script>
      // Mock chrome extension APIs for browser preview
      if (typeof chrome === "undefined" || !chrome.runtime) {
        window.chrome = {
          runtime: { 
            lastError: null, 
            sendMessage: (msg, cb) => {
              console.log('Mock sendMessage:', msg);
              if (cb) cb({ success: false, error: 'Extension environment not detected' });
            },
            onMessage: {
              addListener: (listener) => console.log('Mock runtime.onMessage.addListener'),
              removeListener: (listener) => console.log('Mock runtime.onMessage.removeListener'),
            }
          },
          storage: {
            local: {
              get: (keys, cb) => {
                console.log('Mock storage.get:', keys);
                cb({});
              },
              set: (items, cb) => {
                console.log('Mock storage.set:', items);
                if (cb) cb();
              },
              remove: (keys, cb) => {
                console.log('Mock storage.remove:', keys);
                if (cb) cb();
              },
              getBytesInUse: (keys, cb) => cb(0)
            },
            onChanged: {
              addListener: (listener) => console.log('Mock storage.onChanged.addListener'),
              removeListener: (listener) => console.log('Mock storage.onChanged.removeListener'),
            }
          },
          tabs: {
            query: (queryInfo, cb) => {
              console.log('Mock tabs.query:', queryInfo);
              cb([]);
            },
            sendMessage: (tabId, msg, cb) => {
              console.log('Mock tabs.sendMessage:', tabId, msg);
              if (cb) cb();
            },
            onUpdated: {
              addListener: (listener) => console.log('Mock tabs.onUpdated.addListener'),
              removeListener: (listener) => console.log('Mock tabs.onUpdated.removeListener'),
            },
            onActivated: {
              addListener: (listener) => console.log('Mock tabs.onActivated.addListener'),
              removeListener: (listener) => console.log('Mock tabs.onActivated.removeListener'),
            }
          }
        };
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/sidepanel/main.tsx"></script>
  </body>
</html>
